
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Andy‚Äôs Stag Bingo</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />
  <meta name="theme-color" content="#E91E63" />
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-messaging-compat.js"></script>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="logo" style="background-image:url('icon-192.png');background-size:cover"></div>
      <div>
        <div><strong>Andy‚Äôs Stag: Pub‚Äëto‚ÄëPub Bingo</strong></div>
        <div class="small">Inclusive, consent‚Äëfirst, and full of craic</div>
      </div>
    </div>
    <div class="nav">
      <button data-tab="bingo" class="active">Bingo</button>
      <button data-tab="itinerary">Itinerary</button>
      <button data-tab="scores">Scoreboard</button>
      <button data-tab="timer">Timer</button>
      <button data-tab="install">Install & Share</button>
      <button data-tab="admin">Admin</button>
    </div>
  </header>
  <main>
    <section id="bingo" class="active">
      <div id="roundBar" class="roundbar" style="display:none"><span id="roundMsg">The Round Reminder</span><span id="roundTime">30:00</span></div>
      <div class="card">
        <div class="row" style="justify-content:space-between;align-items:center;flex-wrap:wrap">
          <h3 id="cardTitle">Bingo Card 1/16</h3>
          <span class="small" id="playerHeader" style="opacity:.9"></span>
          <div class="row">
            <button id="prevCard" class="ghost">Previous Card</button>
            <button id="nextCard" class="ghost">Next Card</button>
          </div>
        </div>
        <div id="bingoGrid" class="grid cols-5" aria-live="polite"></div>
        <details class="details">
          <summary>Losers‚Äô Forfeit (tap to reveal)</summary>
          <div>
            <div id="forfeit" style="margin-bottom:8px">Tap ‚ÄòReveal Forfeit‚Äô when needed‚Ä¶</div>
            <button class="primary" onclick="const f=['Wear the ‚ÄúI ‚ù§Ô∏è ANDY‚Äù sash next round.','Dramatic reading of the dessert menu.','Celebrity accent for 5 minutes.','Selfie with the tallest person (ask first).','Two‚Äëline poem about Andy‚Äîread aloud.','Only emojis/mime for the next round.','Carry the inflatable mascot until you win a square.','Compliment three strangers‚Äô shoes.','20‚Äësec power‚Äëballad karaoke.','Serve the table water like a sommelier.']; document.getElementById('forfeit').textContent=f[Math.floor(Math.random()*f.length)];">Reveal Forfeit</button>
          </div>
        </details>
        <p class="small" style="margin-top:12px">Safety note: All interactions must be friendly and voluntary. Always ask permission and respect a ‚Äòno‚Äô. Hydration & food breaks encouraged.</p>
      </div>
    </section>

    <section id="itinerary">
      <div class="card">
        <h3>Weekend Plan</h3>
        <details class="details pink">
          <summary>Friday 29 Aug 2025</summary>
          <div>
            <div class="list">
              <div class="item"><div>Arrive at <strong>Battlebridge Caravan & Camping Park</strong> after work ‚Äì set up, BBQ & drinks at the onsite pub.</div>
                <div class="row">
                  <a class="ghost" href="https://www.battlebridgecaravanandcamping.ie/" target="_blank">Website</a>
                  <a class="ghost" href="https://www.google.com/maps/place/Battlebridge+Caravan+%26+Camping+Park/" target="_blank">Google Maps</a>
                  <button class="primary" onclick="openNav(53.995663, -8.080685, 'Battlebridge Caravan & Camping Park')">Navigate</button>
                </div>
              </div>
            </div>
          </div>
        </details>

        <details class="details pink">
          <summary>Saturday 30 Aug 2025</summary>
          <div class="list">
            <div class="item"><span><span class="badge">10:00</span> Minibus pickup (camp entrance)</span></div>
            <div class="item"><span><span class="badge">10:30</span> <strong>Boda Borg ‚Äì Lough Key</strong></span>
              <div class="row">
                <a class="ghost" href="https://loughkey.ie/activities/boda-borg/" target="_blank">Website</a>
                <a class="ghost" href="https://www.google.com/maps/place/Lough+Key+Forest+%26+Activity+Park/" target="_blank">Google Maps</a>
                <button class="primary" onclick="openNav(53.9815, -8.2966, 'Boda Borg (Lough Key)')">Navigate</button>
              </div>
            </div>
            <div class="item"><span><span class="badge">13:00</span> Lunch ‚Äì <strong>The Jackalope Caf√©</strong></span>
              <div class="row">
                <a class="ghost" href="https://www.thesheddistillery.com/visit-us/" target="_blank">Website</a>
                <a class="ghost" href="https://tasteleitrim.com/place/the-jackalope-cafe-at-the-shed-distillery/" target="_blank">Menu</a>
                <a class="ghost" href="https://www.google.com/maps/place/The+Shed+Distillery/" target="_blank">Google Maps</a>
                <button class="primary" onclick="openNav(54.046867, -8.043888, 'The Jackalope Caf√© (Shed Distillery)')">Navigate</button>
              </div>
            </div>
            <div class="item"><span><span class="badge">15:30</span> <strong>The Shed Distillery Tour</strong></span>
              <div class="row">
                <a class="ghost" href="https://www.thesheddistillery.com/visit-us/" target="_blank">Tour</a>
                <button class="primary" onclick="openNav(54.04745, -8.043626, 'The Shed Distillery')">Navigate</button>
              </div>
            </div>
            <div class="item"><span><span class="badge">17:30</span> Bus back to campsite ‚Äì quick change / freshen up</span></div>
            <div class="item"><span><span class="badge">18:15</span> Meet at pub for pickup</span></div>
            <div class="item"><span><span class="badge">18:45</span> Dinner ‚Äì <strong>The Red Bank</strong> (Carrick‚Äëon‚ÄëShannon)</span>
              <div class="row">
                <a class="ghost" href="https://theredbankrestaurant.ie/" target="_blank">Menu</a>
                <a class="ghost" href="https://www.opentable.ie/r/the-red-bank-restaurant-carrick-on-shannon" target="_blank">Reserve</a>
                <button class="primary" onclick="openNav(53.94495, -8.096484, 'The Red Bank Restaurant')">Navigate</button>
              </div>
            </div>
            <div class="item"><span><span class="badge">20:00</span> Let the Games Begin üôÇ</span></div>
            <div class="item"><span><span class="badge">After dark</span> Taxis back to campsite</span></div>
          </div>
        </details>
      </div>
    </section>

    <section id="scores">
      <div class="card">
        <h3>Scoreboard</h3>
        <table id="scoreTable" style="width:100%;border-collapse:collapse">
          <thead>
            <tr>
              <th style="text-align:left;border-bottom:1px solid #333;padding:6px">Player</</th>
              <th style="text-align:left;border-bottom:1px solid #333;padding:6px">Card #</th>
              <th style="text-align:left;border-bottom:1px solid #333;padding:6px">Completed</th>
            </tr>
          </thead>
          <tbody id="scoreBody"></tbody>
        </table>
      </div>
    </section>

    <section id="timer">
      <div class="card">
        <h3>The Round Reminder (30 mins)</h3>
        <div class="timer">
          <div class="time" id="time">30:00</div>
        </div>
        <p class="small">The Round Reminder is controlled by Admin. The live countdown mirrors here.</p>
      </div>
    </section>

    <section id="install">
      <div class="card">
        <h3>Install & Share</h3>
        <p>Add this as an app for one‚Äëtap access during the night.</p>
        <div id="installHelp" class="card" style="margin-top:12px">
          <h3>Add this app with one‚Äëtap</h3>
          <p>Install to your Home Screen for quick access and fewer prompts.</p>
          <div class="row" style="margin:8px 0">
            <button class="primary" id="installBtn">Install App</button>
          </div>
          <div class="small" style="line-height:1.5">
            <strong>Android (Chrome):</strong> Tap <em>‚ãÆ</em> (top‚Äëright) ‚Üí <em>Add to Home screen</em> ‚Üí <em>Add</em>.<br/>
            <strong>iPhone/iPad (Safari):</strong> Tap <em>Share</em> <span aria-label="Share">‚¨ÜÔ∏è</span> ‚Üí <em>Add to Home Screen</em> ‚Üí <em>Add</em>.
          </div>
        </div>
      </div>
    </section>

    <section id="admin">
      <div class="card">
        <h3>Admin</h3>
        <div id="adminGate">
          <div class="row" style="align-items:center; gap:8px">
            <input id="adminUser" placeholder="Username" style="flex:1;padding:10px;border-radius:10px;border:1px solid #333;background:#151922;color:#e7e7e7" />
            <input id="adminPass" type="password" placeholder="Password" style="flex:1;padding:10px;border-radius:10px;border:1px solid #333;background:#151922;color:#e7e7e7" />
            <button class="primary" id="adminLoginBtn">Login</button>
          </div>
          <p class="small">Admin functions are restricted.</p>
        </div>
        <div id="adminControls" style="display:none">
          <div class="row" style="justify-content:space-between;align-items:center">
            <strong>Global Controls</strong>
            <button class="ghost" id="adminLogoutBtn">Logout</button>
          </div>
          <div class="details" style="margin-top:10px">
            <div class="row" style="gap:12px; flex-wrap:wrap">
              <button class="primary" id="adminStart">Start Round Timer</button>
              <button class="ghost" id="adminPause">Pause Timer</button>
              <button class="ghost" id="adminReset">Reset Timer</button>
            </div>
            <p class="small">These timer actions are broadcast to every device in the game.</p>
          </div>

          <div class="details" style="margin-top:10px">
            <summary>Players & Numbers (CSV)</summary>
            <div>
              <p class="small">Paste CSV as: <code>card,name,phone</code> (card=1..16, phone in E.164 e.g. +353871234567)</p>
              <textarea id="csvArea" rows="6" style="width:100%;padding:10px;border-radius:10px;border:1px solid #333;background:#151922;color:#e7e7e7" placeholder="1,Mick,+353871234567
2,Sarah,+35386...."></textarea>
              <div class="row" style="margin-top:8px">
                <button class="primary" id="btnImportCsv">Import & Save</button>
                <button class="ghost" id="btnExportCsv">Export Current</button>
              </div>
            </div>
          </div>

          <div class="details" style="margin-top:10px">
            <summary>Notifications</summary>
            <div>
              <p class="small">Enable browser notifications for instant in‚Äëapp alerts. Background push requires a server key (optional future step).</p>
              <div class="row"><button class="primary" id="btnEnablePush">Enable Notifications</button></div>
            </div>
          </div>

          <div class="details" style="margin-top:10px">
            <button class="danger" id="adminResetGame">Global Reset Game</button>
            <p class="small">Kicks everyone out of the current game. All players must enter their name again to claim a card.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="banner" aria-live="polite"><div class="track"><div class="msg" id="bannerMsg" style="display:none"></div></div></div>

  <div id="playerModal">
    <div class="modal-card" style="background:#101317;border:1px solid #333;border-radius:14px;padding:16px;max-width:460px;width:92%">
      <h3 style="margin-top:0">Who‚Äôs playing?</h3>
      <p class="small">Enter your name to claim a bingo card. You‚Äôll only be able to edit your own card, but you can view all cards.</p>
      <div class="row" style="margin:8px 0">
        <input id="playerNameInput" placeholder="Your name" style="flex:1;padding:10px;border-radius:10px;border:1px solid #333;background:#151922;color:#e7e7e7"/>
        <button class="primary" onclick="claimCard()">Claim My Card</button>
      </div>
      <div class="small" id="claimHint"></div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>
  <footer>
    <div class="small">Made for Andy O‚ÄôConnor‚Äôs Stag ‚Äì be sound, be safe, tip your bartenders.</div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
